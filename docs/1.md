sequenceDiagram
    participant C as 客户端
    participant H as Hono框架
    participant A as 鉴权模块
    participant S as 状态管理
    participant DB as MongoDB
    participant AI as 大模型服务

    C->>H: HTTP请求（含Token/问题）
    H->>A: 拦截请求，验证Token
    alt 鉴权失败
        A-->>C: 返回401错误
    else 鉴权成功
        A->>S: 更新用户状态（在线/操作计数）
        S->>DB: 写入新状态
        H->>Q: 路由到问答模块
        Q->>DB: 获取历史聊天记录
        DB-->>Q: 返回历史数据
        Q->>AI: 构建Prompt，调用大模型API
        AI-->>Q: 返回AI响应
        Q->>DB: 存储完整对话
        Q-->>C: 返回AI生成的消息
    end